SELECT (a.datecreated)AS entrydate, a.barcodeimage AS 'BarcodeImage', (d.sellingprice*(100+e.gstvalue)/100)AS SELLINGPRICE, a.istransfer, a.CreatedBy AS 'CreatedBy', a.HasDO AS 'HasDO', a.HasSO AS 'HasSO', a.G_DiscAmt AS 'DiscAmt1', a.G_DiscRate AS 'DiscRate1', a.grandtotal AS 'GrandTotal', a.othercharges AS 'OtherCharges', a.freightcharges AS 'FreightCharges', a.locationcode AS 'LocationCode', a.invoiceno AS 'InvoiceNo', a.CustName AS 'CustName', a.Add1 AS 'Add1', a.Add2 AS 'Add2', a.Postcode AS 'Postcode', a.city AS 'City', a.State AS 'State', a.country AS 'Country', a.InvoiceDate, b.GSTRate, b.GSTAmt, a.custcode, a.GSTCharges, a.GSTNo, a.customcharges1, a.Reference AS 'Reference', a.Remark AS 'Remark', CASE WHEN a.isposted='1' THEN 'Y' ELSE 'N' END AS 'IsPosted', b.rowno AS 'RowNo', IFNULL(c.productcode, b.barcode) AS 'Barcode', b.itemcode AS 'ItemCode', b.batchcode AS 'BatchCode', IF(d.GSTCode='03',CONCAT('*',CONCAT(b.description," ",IF(b.remark="",IF(d.rsp=0,"",d.rsp),CONCAT(b.remark," ",IF(d.rsp=0,"",d.rsp))))),IF(d.gstcode='02',CONCAT('**',CONCAT(b.description," ",IF(b.remark="",IF(d.rsp=0,"",d.rsp),CONCAT(b.remark," ",IF(d.rsp=0,"",d.rsp))))),CONCAT(b.description," ",IF(b.remark="",IF(d.rsp=0,"",d.rsp),CONCAT(b.remark," ",IF(d.rsp=0,"",d.rsp)))))) AS 'Description', b.artno AS 'ArtNo', b.remark AS 'Remark', ROUND(b.quantity,2) AS 'Quantity', b.uomid AS 'UOMID', b.uomcode AS 'UOMCode', b.factor AS 'Factor', b.quantity AS 'TotalQuantity', b.unitcost AS 'UnitCost', b.totalcost AS 'TotalCost', b.unitprice AS 'UnitPrice', b.discrate AS 'DiscRate', b.discamt AS 'DiscAMT', b.totalprice AS 'TotalPrice', a.regno 
FROM t_invoice a, t_invoicedetail b 
LEFT JOIN mas_itempacking c ON b.barcode=c.barcode 
LEFT JOIN mas_itemsellingprice d ON b.locationcode=d.locationcode AND b.itemcode=d.itemcode AND b.barcode=d.barcode AND a.priceid=d.priceid 
LEFT JOIN MAS_GST e ON d.GSTID=e.GSTID AND d.GSTCODE=e.GSTCODE
WHERE(a.invoiceno = b.invoiceno AND a.locationcode = b.locationcode) AND a.locationcode='PENAMPANG2' AND a.InvoiceNo='" & g_strInvoiceNo & "' AND ROUND(b.quantity,2) <> '0' ORDER BY rowno ;